{"version":3,"sources":["webpack:///webpack/universalModuleDefinition?5ca6","webpack:///webpack/bootstrap eb2dd716af20958cec97?bd1b","webpack:///external {\"amd\":\"es6-promise\",\"commonjs\":\"es6-promise\",\"commonjs2\":\"es6-promise\",\"root\":\"Promise\"}?b13a","webpack:///./src/test/specs-api/Platform-spec.ts","webpack:///./src/test/mocha-api.ts","webpack:///./~/node-libs-browser/~/process/browser.js","webpack:///./src/test/lib/AccountGenerator.ts","webpack:///external {\"amd\":\"soap\",\"commonjs\":\"soap\",\"commonjs2\":\"soap\",\"root\":\"soap\"}","webpack:///./src/test/lib/AccountGeneratorHelper.ts","webpack:///external {\"amd\":\"chai\",\"commonjs\":\"chai\",\"commonjs2\":\"chai\",\"root\":\"chai\"}","webpack:///external {\"amd\":\"sinon\",\"commonjs\":\"sinon\",\"commonjs2\":\"sinon\",\"root\":\"sinon\"}","webpack:///external {\"amd\":\"sinon-chai\",\"commonjs\":\"sinon-chai\",\"commonjs2\":\"sinon-chai\",\"root\":\"sinonChai\"}","webpack:///external {\"amd\":\"mocha\",\"commonjs\":\"mocha\",\"commonjs2\":\"mocha\",\"root\":\"mocha\"}","webpack:///external {\"amd\":\"../rc-sdk\",\"commonjs\":\"../rc-sdk\",\"commonjs2\":\"../rc-sdk\",\"root\":\"RCSDK\"}","webpack:///./src/test/specs-api/Message-spec.ts"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;;;;;;;;;;;;ACtCA,gD;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT,KAAK;AACL,CAAC;;;;;;;;ACzCD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;;;;;;;;;ACpBA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA,4BAA4B,UAAU;;;;;;;;ACzFtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D;AAC9D;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA,CAAC;AACD;;;;;;;;AChFA,gD;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB,iBAAiB;AACjB;AACA,+BAA+B,WAAW;AAC1C;AACA;AACA;AACA,qBAAqB;AACrB;AACA,iBAAiB;AACjB;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA,iBAAiB;AACjB;AACA;AACA;AACA,iBAAiB;AACjB;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;;;;;;;AC1DA,gD;;;;;;;ACAA,gD;;;;;;;ACAA,gD;;;;;;;ACAA,gD;;;;;;;ACAA,gD;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,gDAAgD,mBAAmB;AACnE,0BAA0B;AAC1B,iBAAiB;AACjB,aAAa;AACb;AACA;AACA;AACA,iBAAiB;AACjB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,4CAA4C,YAAY;AACxD;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA,SAAS;AACT,KAAK;AACL,CAAC","file":"./build/tests/specs-api.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"es6-promise\"), require(\"soap\"), require(\"chai\"), require(\"sinon\"), require(\"sinon-chai\"), require(\"mocha\"), require(\"../rc-sdk\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"es6-promise\", \"soap\", \"chai\", \"sinon\", \"sinon-chai\", \"mocha\", \"../rc-sdk\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"RCSDK\"] = factory(require(\"es6-promise\"), require(\"soap\"), require(\"chai\"), require(\"sinon\"), require(\"sinon-chai\"), require(\"mocha\"), require(\"../rc-sdk\"));\n\telse\n\t\troot[\"RCSDK\"] = factory(root[\"Promise\"], root[\"soap\"], root[\"chai\"], root[\"sinon\"], root[\"sinonChai\"], root[\"mocha\"], root[\"RCSDK\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_41__, __WEBPACK_EXTERNAL_MODULE_49__, __WEBPACK_EXTERNAL_MODULE_51__, __WEBPACK_EXTERNAL_MODULE_52__, __WEBPACK_EXTERNAL_MODULE_53__, __WEBPACK_EXTERNAL_MODULE_54__, __WEBPACK_EXTERNAL_MODULE_55__) {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap eb2dd716af20958cec97\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_41__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"amd\":\"es6-promise\",\"commonjs\":\"es6-promise\",\"commonjs2\":\"es6-promise\",\"root\":\"Promise\"}\n ** module id = 41\n ** module chunks = 0 1\n **/","/// <reference path=\"../../typings/externals.d.ts\" />\nexports.mocha = require('../mocha-api');\nvar expect = exports.mocha.chai.expect;\nvar spy = exports.mocha.sinon.spy;\nvar rcsdk = exports.mocha.rcsdk;\nvar accountGenerator = exports.mocha.accountGenerator;\nvar accountGeneratorHelper = exports.mocha.accountGeneratorHelper;\ndescribe('RCSDK.core.Plafrorm', function () {\n    var platform = rcsdk.getPlatform();\n    this.timeout(5000);\n    describe('authorize', function () {\n        accountGeneratorHelper.registerHooks(this, 'platform_messages', 1, false);\n        it('authorizes with right credentials', function (done) {\n            platform\n                .authorize({\n                username: this.accounts[0].mainPhoneNumber,\n                password: this.accounts[0].password\n            })\n                .then(function (ajax) {\n                expect(ajax.data).to.have.property('access_token').to.be.ok;\n                done();\n            })\n                .catch(function (e) {\n                done(e);\n            });\n        });\n        it('fails to authorize with wrong data', function (done) {\n            platform\n                .authorize({\n                username: this.accounts[0].mainPhoneNumber,\n                password: this.accounts[0].password + '-random-stuff'\n            })\n                .then(function (ajax) {\n                done(new Error('This should not be reached'));\n            })\n                .catch(function (e) {\n                expect(e.message).to.be.equal('Invalid resource owner credentials.');\n                done();\n            });\n        });\n    });\n});\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/test/specs-api/Platform-spec.ts\n ** module id = 45\n ** module chunks = 1\n **/","/// <reference path=\"../typings/externals.d.ts\" />\nif (!process.env.RCSDK_API_SERVER)\n    throw new Error('Process.env.RCSDK_API_SERVER is undefined');\nif (!process.env.RCSDK_API_KEY)\n    throw new Error('Process.env.RCSDK_API_KEY is undefined');\nvar ag = require('./lib/AccountGenerator');\nvar agh = require('./lib/AccountGeneratorHelper');\nexports.chai = require('chai');\nexports.sinon = require(\"sinon\");\nexports.sinonChai = require('sinon-chai');\nexports.mocha = require('mocha');\nexports.RCSDK = require('../lib/RCSDK');\nexports.rcsdk = new exports.RCSDK({\n    server: process.env.RCSDK_API_SERVER,\n    appKey: 'whatever',\n    appSecret: 'whatever'\n});\nexports.rcsdk.getPlatform().apiKey = process.env.RCSDK_API_KEY;\nexports.chai.use(exports.sinonChai);\nexports.accountGenerator = new ag.AccountGenerator(process.env.RCSDK_AGS_SERVER);\nexports.accountGeneratorHelper = new agh.AccountGeneratorHelper(exports.accountGenerator, process.env.RCSDK_AGS_DBNAME);\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/test/mocha-api.ts\n ** module id = 46\n ** module chunks = 1\n **/","// shim for using process in browser\n\nvar process = module.exports = {};\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = setTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            currentQueue[queueIndex].run();\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    clearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        setTimeout(drainQueue, 0);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\n// TODO(shtylman)\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/node-libs-browser/~/process/browser.js\n ** module id = 47\n ** module chunks = 1\n **/","/// <reference path=\"../../typings/externals.d.ts\" />\nvar promise = require('es6-promise');\nvar soap = require('soap');\nvar Promise = promise.Promise;\nvar AccountGenerator = (function () {\n    /**\n     * @name AccountGenerator\n     * @param {string} server\n     * @constructor\n     */\n    function AccountGenerator(server) {\n        if (!server)\n            throw new Error('Server is not defined');\n        this.server = server;\n        this.client = null;\n        this.connectionPromise = null;\n    }\n    AccountGenerator.prototype.ensureClient = function () {\n        if (!this.client)\n            throw new Error('Client is not connected');\n        return this;\n    };\n    AccountGenerator.prototype.connect = function () {\n        var self = this;\n        if (this.client) {\n            console.info('AccountGenerator: Client already has connection');\n            return this.connectionPromise;\n        }\n        this.connectionPromise = new Promise(function (resolve, reject) {\n            var url = self.server + '/ags/ws?wsdl';\n            console.log('Connecting to', url);\n            soap.createClient(url, function (e, cl) {\n                console.info('AccountGenerator: SOAP has been connected', e && e.message || '');\n                if (e)\n                    throw e;\n                self.client = cl;\n                resolve(self.client);\n            });\n        });\n        return this.connectionPromise;\n    };\n    AccountGenerator.prototype.getAndLock = function (config) {\n        var _this = this;\n        return new Promise(function (resolve, reject) {\n            _this.ensureClient();\n            if (!config.dbName)\n                throw new Error('No dbName specified');\n            if (!config.scenario)\n                throw new Error('No scenario specified');\n            if (!config.accountCount)\n                throw new Error('No accountCount specified');\n            config.accountCount = config.accountCount.toString();\n            _this.client.getAndLock(config, function (e, result) {\n                if (e)\n                    throw e;\n                var accounts = result.accounts.account.length ? result.accounts.account : [result.accounts.account];\n                resolve(accounts);\n            });\n        });\n    };\n    AccountGenerator.prototype.release = function (config) {\n        var _this = this;\n        return new promise.Promise(function (resolve, reject) {\n            _this.ensureClient();\n            if (!config.dbName)\n                throw new Error('No dbName specified');\n            if (!config.rcUserIds)\n                throw new Error('No scenario specified');\n            config.modified = config.modified ? 'true' : 'false';\n            if (Array.isArray(config.rcUserIds))\n                config.rcUserIds = config.rcUserIds.join(','); //TODO This may not work\n            _this.client.release(config, function (e, result) {\n                if (e)\n                    throw e;\n                resolve(result);\n            });\n        });\n    };\n    return AccountGenerator;\n})();\nexports.AccountGenerator = AccountGenerator;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/test/lib/AccountGenerator.ts\n ** module id = 48\n ** module chunks = 1\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_49__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"amd\":\"soap\",\"commonjs\":\"soap\",\"commonjs2\":\"soap\",\"root\":\"soap\"}\n ** module id = 49\n ** module chunks = 1\n **/","var AccountGeneratorHelper = (function () {\n    function AccountGeneratorHelper(accountGenerator, dbName) {\n        this.registerHooks = function (suite, scenario, count, modified) {\n            if (!count)\n                count = 1;\n            var self = this;\n            suite.beforeEach(function (done) {\n                var test = this;\n                test.accounts = [];\n                self.accountGenerator\n                    .connect()\n                    .then(function (client) {\n                    return self.accountGenerator.getAndLock({\n                        dbName: self.dbName,\n                        scenario: 'platform_messages',\n                        accountCount: count\n                    });\n                })\n                    .then(function (accounts) {\n                    /** @type {IAccount[]} */\n                    test.accounts = accounts;\n                    console.info('Accounts acquired', test.accounts.map(function (account) {\n                        return account.mainPhoneNumber + ':' + account.password;\n                    }).join(', '));\n                    done();\n                })\n                    .catch(done);\n            });\n            suite.afterEach(function (done) {\n                var test = this;\n                if (test.accounts.length == 0) {\n                    console.info('Nothing to release');\n                    return done();\n                }\n                self.accountGenerator\n                    .release({\n                    dbName: self.dbName,\n                    rcUserIds: test.accounts.map(function (account) {\n                        return account.userId;\n                    }),\n                    modified: modified\n                })\n                    .then(function (result) {\n                    console.info('Accounts released');\n                    done();\n                })\n                    .catch(done);\n            });\n        };\n        if (!accountGenerator)\n            throw new Error('No accountGenerator specified');\n        if (!dbName)\n            throw new Error('No dbname specified');\n        this.accountGenerator = accountGenerator;\n        this.dbName = dbName;\n    }\n    return AccountGeneratorHelper;\n})();\nexports.AccountGeneratorHelper = AccountGeneratorHelper;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/test/lib/AccountGeneratorHelper.ts\n ** module id = 50\n ** module chunks = 1\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_51__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"amd\":\"chai\",\"commonjs\":\"chai\",\"commonjs2\":\"chai\",\"root\":\"chai\"}\n ** module id = 51\n ** module chunks = 1 2\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_52__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"amd\":\"sinon\",\"commonjs\":\"sinon\",\"commonjs2\":\"sinon\",\"root\":\"sinon\"}\n ** module id = 52\n ** module chunks = 1 2\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_53__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"amd\":\"sinon-chai\",\"commonjs\":\"sinon-chai\",\"commonjs2\":\"sinon-chai\",\"root\":\"sinonChai\"}\n ** module id = 53\n ** module chunks = 1 2\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_54__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"amd\":\"mocha\",\"commonjs\":\"mocha\",\"commonjs2\":\"mocha\",\"root\":\"mocha\"}\n ** module id = 54\n ** module chunks = 1 2\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_55__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"amd\":\"../rc-sdk\",\"commonjs\":\"../rc-sdk\",\"commonjs2\":\"../rc-sdk\",\"root\":\"RCSDK\"}\n ** module id = 55\n ** module chunks = 1 2\n **/","/// <reference path=\"../../typings/externals.d.ts\" />\nexports.mocha = require('../mocha-api');\nvar expect = exports.mocha.chai.expect;\nvar spy = exports.mocha.sinon.spy;\nvar rcsdk = exports.mocha.rcsdk;\nvar accountGenerator = exports.mocha.accountGenerator;\nvar accountGeneratorHelper = exports.mocha.accountGeneratorHelper;\ndescribe('RCSDK.helpers.Message', function () {\n    var platform = rcsdk.getPlatform(), Message = rcsdk.getMessageHelper(), PhoneNumber = rcsdk.getPhoneNumberHelper();\n    this.timeout(5000);\n    describe('saveRequest', function () {\n        accountGeneratorHelper.registerHooks(this, 'platform_messages', 1, false);\n        it('sends message', function (done) {\n            platform\n                .authorize({\n                username: this.accounts[0].mainPhoneNumber,\n                password: this.accounts[0].password\n            })\n                .then(function (ajax) {\n                return platform.apiCall({\n                    url: PhoneNumber.createUrl({ extensionId: '~' }),\n                    get: { perPage: 'max' }\n                });\n            })\n                .then(function (numbersAjax) {\n                return numbersAjax.data.records.filter(PhoneNumber.filter({\n                    type: 'Sms'\n                }))[0];\n            })\n                .then(function (number) {\n                if (!number)\n                    throw new Error('No SMS-enabled phone numbers');\n                return platform.apiCall({\n                    method: 'POST',\n                    url: Message.createUrl({ sms: true }),\n                    post: {\n                        from: number.phoneNumber,\n                        to: number.phoneNumber,\n                        text: 'foo'\n                    }\n                });\n            })\n                .then(function (messageAjax) {\n                expect(messageAjax.data.subject).to.equal('foo');\n            })\n                .catch(done);\n        });\n    });\n});\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/test/specs-api/Message-spec.ts\n ** module id = 56\n ** module chunks = 1\n **/"],"sourceRoot":""}